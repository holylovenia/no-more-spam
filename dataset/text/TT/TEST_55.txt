Native window not shown in JNIHi,

I've written a JNI OpenGL program, but the native OpenGL window isn't
being shown. I am new to cocoa and Apple windowing development and
don't understand why the window isn't shown even though the print
statements in the OpenGL drawing code are all executed. Below is a
section of code in C and java that should create and display the
window then draw a simple OpenGL object.

David


// object-C code
int InitWindowMac(JNIEnv * env, jobject panel)
{	
	std::cout ExceptionOccurred() )
	{
		env->ExceptionDescribe();
	}
	assert(result != JNI_FALSE);
	
	std::cout ExceptionOccurred() )
	{
		env->ExceptionDescribe();
	}
	assert(ds != NULL);
	
	std::cout Lock(ds);	
	if( env->ExceptionOccurred() )
	{
		env->ExceptionDescribe();
	}
	assert( (lock & JAWT_LOCK_ERROR) == 0 );
	
	std::cout GetDrawingSurfaceInfo(ds);
	if(dsi)
	{
		dsi_mac = (JAWT_MacOSXDrawingSurfaceInfo*)dsi->platformInfo;
		if( env->ExceptionOccurred() )
		{
			env->ExceptionDescribe();
		}
	}
	else
	{
		std::cout cocoaViewRef;" cocoaViewRef;

	std::cout context = NULL;
	cp->str = "";

	context = [NSOpenGLContext alloc];
	
	if ( context )
	{
		std::cout context = context;
	
	// match java		
	NSRect windowRect = [window frame];
	CGAffineTransform xform = CGAffineTransformMake(1, 0, 0, -1,
dsi->bounds.x, windowRect.size.height-dsi->bounds.y);
	CGContextConcatCTM( (CGContext*)context, xform );

	if(cp)
		BuildLinkList(env, panel, cp);
	else
	{
		std::cout GetObjectClass(panel);
	jmethodID method = env->GetMethodID(cls, "getName", "()Ljava/lang/String;");
	jstring name = (jstring) env->CallObjectMethod(panel,method);
	const char * chr = env->GetStringUTFChars(name, 0);

	std::string str = chr;
        cp = contextList->retrieve_item(str);

		if( !cp )
		{
			std::cout << "graphics context is not in the graphics context
list"<< std::endl;
			return false;
		}
                int ret = GetCurrentContext();
		return ret;

}


// java code

	public void gl_draw()
	{
		
		// ensure that the OpenGL is correctly initialized
		if(isInitalized == false)
		{
			try
			{
				makeOpenGLWindow(1);
			}
			catch(Exception e)
			{
				e.printStackTrace();
				return;
			}
			gl_init();
			isInitalized = true;
		}			
		
		// find the correct panel to draw the OpenGL into.
		setForDrawing();		
		
		System.out.println("gl_draw()");
		if(!picking)
		{
			reSizeGLScene( getWidth(), getHeight() );
			System.out.println("!picking");
		}
		
 		//draw
		glClearColor(backgroundColour[0], backgroundColour[1],
backgroundColour[2], backgroundColour[3]);

		System.out.println("After glClearColor");

 	 	glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
		System.out.println("After glClear");
 	 	glMatrixMode(GL_MODELVIEW);
		System.out.println("After glMatrixMode");
 	 	glLoadIdentity();
		System.out.println("After glLoadIdentity");

 	 	gluLookAt(eye_x, eye_y, eye_z, lookatX, lookatY, lookatZ, upX, upY, upZ);
		System.out.println("After gluLookAt");

		glDisable(GL_LIGHTING);
		glDisable(GL_LIGHT0);

		System.out.println("After glDisable");
		
		glEnable(GL_CULL_FACE);
		glCullFace(GL_BACK);
				
		glTranslatef(0.0f, 0.0f, 5.0f);

		System.out.println("After glTranslate");

 	 	// 3rd blue
		glColor3f(0.0f, 0.0f, 1.0f);
		glPushName(21);
			System.out.println("After glPushName");
			glPushMatrix();
				glTranslatef(1.3f, 0f, 10.0f);
				System.out.println("After glTranslate");
				glBegin(GL_TRIANGLES);
					glVertex3f(0.0f, 0.0f, 0.0f);
					glVertex3f(2.0f, 0.0f, 0.0f);
					glVertex3f(1.0f, 2.0f, 0.0f);
				glEnd();
			glPopMatrix();
		glPopName();

		System.out.println("After blue");
	 			
		glDisable(GL_CULL_FACE);
		glEnable(GL_LIGHTING);
		glEnable(GL_LIGHT0);

		System.out.println("Before glFlush()");

 	 	glFlush();
		System.out.println("After glFlush()");
 	    swapBuffers();		
		System.out.println("After swapBuffers()");
	}
 _______________________________________________
Do not post admin requests to the list. They will be ignored.
Java-dev mailing list      (Java-dev@lists.apple.com)
Help/Unsubscribe/Update your Subscription:
http://lists.apple.com/mailman/options/java-dev/mlsubscriber.tech%40csmining.org

This email sent to mlsubscriber.tech@csmining.org